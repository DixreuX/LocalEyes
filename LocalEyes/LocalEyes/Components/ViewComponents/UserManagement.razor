@page "/user-management"

@using LocalEyes.Data
@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Identity

@inject AuthenticationStateProvider AuthenticationStateProvider
@inject Microsoft.AspNetCore.Components.NavigationManager NavigationManager
@inject SignInManager<ApplicationUser> SignInManager

@code {

    private string userName;

    protected override async Task OnInitializedAsync()
    {
        var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;
        userName = user.Identity?.Name;
    }

    private async Task Logout()
    {
        await SignInManager.SignOutAsync();

        NavigationManager.NavigateTo("/Account/Pages/Login");
    }

    private async Task ManageAccount()
    {
        NavigationManager.NavigateTo("/Account/Pages/Manage/Index");
    }

    private void HandleClick()
    {
        Console.WriteLine("Button clicked");
    }
}

<div class="user-management">
        

    @if (!string.IsNullOrEmpty(userName))
    {
        <p>Welcome, @userName!</p>
    }
    else
    {
        <p>Not logged in.</p>
    }


    <button type="button" class="btn btn-primary" @onclick="ManageAccount" >Manage profile</button>

    <button type="button" class="btn btn-danger" @onclick="Logout">Logout</button>

    <button @onclick="HandleClick">Click Me</button>
   

</div>
